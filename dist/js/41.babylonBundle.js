(self.webpackChunkbabylonjs_typescript_webpack_simple_scene=self.webpackChunkbabylonjs_typescript_webpack_simple_scene||[]).push([[41,292,124,59],{4292:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Buoyancy:()=>r});var a=n(1465),r=function(){function e(e,t,n){void 0===t&&(t=5),void 0===n&&(n=1),this._size=e,this._displacementMap=null,this._lengthScale=0,this._numSteps=t,this._attenuation=n,this._meshes=[]}return e.prototype.setWaterHeightMap=function(e,t){this._displacementMap=e,this._lengthScale=t},e.prototype.addMesh=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=0),this._meshes.push({mesh:e,frame:t,yOffset:n,spaceCoordinates:r,initQuaternion:e.rotationQuaternion.clone(),curStep:0,curQuaternion:new a._fP,stepQuaternion:new a._fP})},Object.defineProperty(e.prototype,"attenuation",{get:function(){return this._attenuation},set:function(e){this._attenuation=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numSteps",{get:function(){return this._numSteps},set:function(e){this._numSteps=e},enumerable:!1,configurable:!0}),e.prototype.update=function(){for(var e=0;e<this._meshes.length;++e)this._updateMesh(this._meshes[e])},e.prototype.getWaterHeight=function(e){var t=a.jp9.Vector3[0];return this._getWaterDisplacement(e,t),e.subtractToRef(t,t),this._getWaterDisplacement(e,t),e.subtractToRef(t,t),this._getWaterDisplacement(e,t),e.subtractToRef(t,t),this._getWaterDisplacement(e,t),t.y},e.prototype._updateMesh=function(e){var t=a.jp9.Vector3[5],n=a.jp9.Vector3[6],r=a.jp9.Vector3[7],i=a.jp9.Vector3[8],o=a.jp9.Vector3[9],s=a.jp9.Vector3[10],c=a.jp9.Vector3[11],l=a.jp9.Vector3[12],u=e.mesh,d=e.frame,_=e.yOffset,p=e.spaceCoordinates,h=e.initQuaternion,f=e.curQuaternion,m=e.stepQuaternion,v=e.curStep;a.Pa4.TransformCoordinatesToRef(d.v1,u.getWorldMatrix(),t);var b=this.getWaterHeight(t);if(u.position.y=b+_,d.v2&&d.v3){if(v<this._numSteps)return e.curStep++,f.multiplyToRef(m,f),void h.multiplyToRef(f,u.rotationQuaternion);a.Pa4.TransformCoordinatesToRef(d.v2,u.getWorldMatrix(),n),n.subtractToRef(t,c),c.normalize(),a.Pa4.TransformCoordinatesToRef(d.v3,u.getWorldMatrix(),r),r.subtractToRef(t,l),l.normalize(),t.y=b,i.copyFrom(n),i.y=this.getWaterHeight(n),i.subtractToRef(t,i),i.normalize(),o.copyFrom(r),o.y=this.getWaterHeight(r),o.subtractToRef(t,o),o.normalize(),a.Pa4.CrossToRef(o,i,s),a.Pa4.CrossToRef(i,s,o),o.normalize();var g=Math.acos(a.Rus.Clamp(a.Pa4.Dot(c,i),0,1))*this._attenuation,y=Math.acos(a.Rus.Clamp(a.Pa4.Dot(l,o),0,1))*this._attenuation;switch(p){case 0:i.y>c.y&&(g=-g),o.y>l.y&&(y=-y),a._fP.FromEulerAnglesToRef(g/this._numSteps,y/this._numSteps,0,e.stepQuaternion);break;case 1:i.y>c.y&&(g=-g),o.y<l.y&&(y=-y),a._fP.FromEulerAnglesToRef(g/this._numSteps,0,y/this._numSteps,e.stepQuaternion);break;case 2:i.y>c.y&&(g=-g),o.y>l.y&&(y=-y),a._fP.FromEulerAnglesToRef(g/this._numSteps,0,y/this._numSteps,e.stepQuaternion)}e.curStep=0}},e.prototype._getWaterDisplacement=function(e,t){if(this._displacementMap){var n=this._size-1,r=e.x/this._lengthScale*this._size,i=e.z/this._lengthScale*this._size,o=a.jp9.Vector3[1],s=a.jp9.Vector3[2],c=a.jp9.Vector3[3],l=a.jp9.Vector3[4],u=Math.floor(r),d=Math.floor(i),_=r-u,p=i-d;u&=n,d&=n,this._getDisplacement(u,d,o),this._getDisplacement(u+1&n,d,s),s.subtractToRef(o,c).scaleToRef(_,c).addToRef(o,c),this._getDisplacement(u,d+1&n,o),this._getDisplacement(u+1&n,d+1&n,s),s.subtractToRef(o,l).scaleToRef(_,l).addToRef(o,l),l.subtractToRef(c,t).scaleToRef(p,t).addToRef(c,t)}else t.set(e.x,e.y,e.z)},e.prototype._getDisplacement=function(e,t,n){this._displacementMap&&(n.x=a.OiL.FromHalfFloat(this._displacementMap[t*this._size*4+4*e+0]),n.y=a.OiL.FromHalfFloat(this._displacementMap[t*this._size*4+4*e+1]),n.z=a.OiL.FromHalfFloat(this._displacementMap[t*this._size*4+4*e+2]))},e}()},4041:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Ocean:()=>p,default:()=>h});var a=n(1465),r=n(5811),i=n(6853),o=n(4059),s=n(6124),c=n(4292);n(5026);const l=n.p+"cb69d722ba0e1aed94b8f0e32058b799.exr",u=n.p+"e388a5748796486181fbb8cb94bd0a66.glb",d=n.p+"1f306a6325b8c6d21b8125e742b24167.glb",_=n.p+"5b0b186220463f71ca8c72af6f8a9434.glb";var p=function(){function e(){this._engine=null,this._scene=null,this._camera=null,this._rttDebug=null,this._light=null,this._depthRenderer=null}return e.prototype.createScene=function(e,t){return n=this,p=void 0,f=function(){var n,p,h,f,m,v,b,g,y,w,x,C,S,D,T,V,U=this;return function(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(M){switch(M.label){case 0:return window.convf=function(e){var t=new Uint8Array([255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24]);return new Float32Array(t.buffer)[0]},window.numbg=function(){console.log("NumBindGroupsCreatedTotal=",a.C49.NumBindGroupsCreatedTotal," - NumBindGroupsCreatedLastFrame=",a.C49.NumBindGroupsCreatedLastFrame)},n=new a.xsS(e),this._engine=e,this._scene=n,this._rttDebug=new r.RTTDebug(n,e,32),this._rttDebug.show(!1),n.environmentIntensity=1,this._camera=new a.cEJ("mainC",new a.Pa4(-17.3,5,-9),n),this._camera.rotation.set(.21402315044176745,1.5974857677541419,0),this._camera.minZ=1,this._camera.maxZ=1e3,n.activeCameras=[this._camera,this._rttDebug.camera],this._camera.attachControl(t,!0),this._depthRenderer=this._scene.enableDepthRenderer(this._camera,!1),this._depthRenderer.getDepthMap().renderList=[],this._light=new a.Ox3("light",new a.Pa4(0,-1,-.25),n),this._light.intensity=1,this._light.diffuse=new a.Wot(1,.95686275,.8392157),p=256,h=new c.Buoyancy(p,4,.2),f=new o.SkyBox(!0,n),[4,a.n0n.AppendAsync("",u,n,void 0,".glb")];case 1:return M.sent(),(m=n.getMeshByName("pTorus5_lambert1_0")).scaling.setAll(.1),m.position.y=-.3,m.position.z=-15,this._depthRenderer.getDepthMap().renderList.push(m),h.addMesh(m,{v1:new a.Pa4(0,5,-6),v2:new a.Pa4(0,5,6),v3:new a.Pa4(5,5,-6)},-.3,1),[4,a.n0n.AppendAsync("",d,n,void 0,".glb")];case 2:return M.sent(),(v=n.getTransformNodeByName("Cube.022")).scaling.setAll(3),v.position.x=-5,v.position.y=1.5,v.position.z=-10,(V=this._depthRenderer.getDepthMap().renderList).push.apply(V,v.getChildMeshes(!1)),h.addMesh(v,{v1:new a.Pa4(0,2,0),v2:new a.Pa4(0,-1.2,0),v3:new a.Pa4(.4,2,0)},1.5,0),[4,a.n0n.AppendAsync("",_,n,void 0,".glb")];case 3:return M.sent(),(b=n.getMeshByName("tsunami_buoy_tsunami_buoy_0")).scaling.setAll(.0175),b.bakeCurrentTransformIntoVertices(),b.parent=null,b.alwaysSelectAsActiveMesh=!0,this._depthRenderer.getDepthMap().renderList.push(b),h.addMesh(b,{v1:new a.Pa4(.7,1,-1.5),v2:new a.Pa4(.7,1,1.5),v3:new a.Pa4(-1.5,1,-1.5)},-.5,2),(g=a.VO7.CreateSphere("sp1",{diameter:1.2},n)).parent=b,g.position.x=.7,g.position.y=1,g.position.z=-1.5,(y=a.VO7.CreateSphere("sp2",{diameter:1.2},n)).parent=b,y.position.x=.7,y.position.y=1,y.position.z=1.5,(w=a.VO7.CreateSphere("sp3",{diameter:1.2},n)).parent=b,w.position.x=-1.5,w.position.y=1,w.position.z=-1.5,n.stopAllAnimations(),(x=a.vU0.CreateGround("patch",{width:242,height:242,subdivisions:240},n)).position.x=121,x.position.z=121,x.bakeCurrentTransformIntoVertices(),window.pp=x,x.position.set(-14.9,0,-25),x.scaling.set(.12397,1,.12397),[4,fetch(l)];case 4:return[4,M.sent().arrayBuffer()];case 5:return C=M.sent(),S=new i.WavesGenerator(p,n,this._rttDebug,C),D=new s.OceanMaterial(S,this._depthRenderer,n),T=x,[4,D.getMaterial(!0,!0)];case 6:return T.material=M.sent(),n.onBeforeRenderObservable.add((function(){f.update(U._light),S.update(),h.setWaterHeightMap(S.waterHeightMap,S.waterHeightMapScale),h.update()})),[2,n]}}))},new((h=void 0)||(h=Promise))((function(e,t){function a(e){try{i(f.next(e))}catch(e){t(e)}}function r(e){try{i(f.throw(e))}catch(e){t(e)}}function i(t){var n;t.done?e(t.value):(n=t.value,n instanceof h?n:new h((function(e){e(n)}))).then(a,r)}i((f=f.apply(n,p||[])).next())}));var n,p,h,f},e}();const h=new p},6124:(e,t,n)=>{"use strict";n.r(t),n.d(t,{OceanMaterial:()=>o});var a=n(1465),r=n(5454);const i=n.p+"9c85eca814352b70dd5242dd178d6d9c.jpg";var o=function(){function e(e,t,n){var r,o;this._wavesGenerator=e,this._depthRenderer=t,this._scene=n,this._camera=null!==(o=null===(r=n.activeCameras)||void 0===r?void 0:r[0])&&void 0!==o?o:n.activeCamera,this._foamTexture=new a.xEZ(i,this._scene),this._startTime=(new Date).getTime()/1e3}return e.prototype.getMaterial=function(e,t,n){return void 0===n&&(n=!1),i=this,o=void 0,c=function(){var i,o,s=this;return function(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(c){switch(c.label){case 0:return n?[3,1]:((i=new r.B_("mat",this._scene)).metallic=0,i.roughness=.311,i.forceIrradianceInFragment=!0,i.AddUniform("_LOD_scale","float",7.13),i.AddUniform("_FoamColor","vec3",new a.Pa4(1,1,1)),i.AddUniform("_SSSStrength","float",.133),i.AddUniform("_Color","vec3",new a.Pa4(.03457636,.12297464,.1981132)),i.AddUniform("_SSSColor","vec3",new a.Pa4(.1541919,.8857628,.990566)),i.AddUniform("_SSSBase","float",-.1),i.AddUniform("_SSSScale","float",4.8),i.AddUniform("_MaxGloss","float",.91),i.AddUniform("_RoughnessScale","float",.0044),i.AddUniform("_FoamBiasLOD0","float",.84),i.AddUniform("_FoamBiasLOD1","float",1.83),i.AddUniform("_FoamBiasLOD2","float",2.72),i.AddUniform("_FoamScale","float",2.4),i.AddUniform("_ContactFoam","float",1),i.AddUniform("_WorldSpaceCameraPos","vec3",""),i.AddUniform("LengthScale0","float",this._wavesGenerator.lengthScale[0]),i.AddUniform("LengthScale1","float",this._wavesGenerator.lengthScale[1]),i.AddUniform("LengthScale2","float",this._wavesGenerator.lengthScale[2]),i.AddUniform("_Displacement_c0","sampler2D",this._wavesGenerator.getCascade(0).displacement),i.AddUniform("_Derivatives_c0","sampler2D",this._wavesGenerator.getCascade(0).derivatives),i.AddUniform("_Turbulence_c0","sampler2D",this._wavesGenerator.getCascade(0).turbulence),i.AddUniform("_Displacement_c1","sampler2D",this._wavesGenerator.getCascade(1).displacement),i.AddUniform("_Derivatives_c1","sampler2D",this._wavesGenerator.getCascade(1).derivatives),i.AddUniform("_Turbulence_c1","sampler2D",this._wavesGenerator.getCascade(1).turbulence),i.AddUniform("_Displacement_c2","sampler2D",this._wavesGenerator.getCascade(2).displacement),i.AddUniform("_Derivatives_c2","sampler2D",this._wavesGenerator.getCascade(2).derivatives),i.AddUniform("_Turbulence_c2","sampler2D",this._wavesGenerator.getCascade(2).turbulence),i.AddUniform("_Time","float",0),i.AddUniform("_CameraDepthTexture","sampler2D",this._depthRenderer.getDepthMap()),i.AddUniform("_CameraData","vec4",new a.Ltg(this._camera.minZ,this._camera.maxZ,this._camera.maxZ-this._camera.minZ,0)),i.AddUniform("_FoamTexture","sampler2D",this._foamTexture),o=[],e&&o.push("#define MID"),t&&o.push("#define CLOSE"),i.Vertex_Definitions("\n                "+o.join("\n")+"\n\n                varying vec2 vWorldUV;\n                varying vec2 vUVCoords_c0;\n                varying vec2 vUVCoords_c1;\n                varying vec2 vUVCoords_c2;\n                varying vec3 vViewVector;\n                varying vec4 vLodScales;\n                varying vec4 vClipCoords;\n                varying float vMetric;\n            "),i.Fragment_Definitions("\n                "+o.join("\n")+"\n\n                varying vec2 vWorldUV;\n                varying vec2 vUVCoords_c0;\n                varying vec2 vUVCoords_c1;\n                varying vec2 vUVCoords_c2;\n                varying vec3 vViewVector;\n                varying vec4 vLodScales;\n                varying vec4 vClipCoords;\n                varying float vMetric;\n            "),i.Vertex_After_WorldPosComputed("\n                vWorldUV = worldPos.xz;\n            \n                vViewVector = _WorldSpaceCameraPos - worldPos.xyz;\n                float viewDist = length(vViewVector);\n            \n                float lod_c0 = min(_LOD_scale * LengthScale0 / viewDist, 1.0);\n                float lod_c1 = min(_LOD_scale * LengthScale1 / viewDist, 1.0);\n                float lod_c2 = min(_LOD_scale * LengthScale2 / viewDist, 1.0);\n                    \n                vec3 displacement = vec3(0.);\n                float largeWavesBias = 0.;\n            \n                vUVCoords_c0 = vWorldUV / LengthScale0;\n                vUVCoords_c1 = vWorldUV / LengthScale1;\n                vUVCoords_c2 = vWorldUV / LengthScale2;\n            \n                displacement += texture2D(_Displacement_c0, vUVCoords_c0).xyz * lod_c0;\n                largeWavesBias = displacement.y;\n            \n                #if defined(MID) || defined(CLOSE)\n                    displacement += texture2D(_Displacement_c1, vUVCoords_c1).xyz * lod_c1;\n                #endif\n                #if defined(CLOSE)\n                    displacement += texture2D(_Displacement_c2, vUVCoords_c2).xyz * lod_c2;\n                #endif\n    \n                worldPos.xyz += displacement;\n\n                vLodScales = vec4(lod_c0, lod_c1, lod_c2, max(displacement.y - largeWavesBias * 0.8 - _SSSBase, 0) / _SSSScale);\n            "),i.Vertex_MainEnd("\n                vClipCoords = gl_Position;\n                vMetric = gl_Position.z;\n            "),i.Fragment_Before_Lights("\n                vec4 derivatives = texture2D(_Derivatives_c0, vUVCoords_c0);\n                #if defined(MID) || defined(CLOSE)\n                    derivatives += texture2D(_Derivatives_c1, vUVCoords_c1) * vLodScales.y;\n                #endif\n                #if defined(CLOSE)\n                    derivatives += texture2D(_Derivatives_c2, vUVCoords_c2) * vLodScales.z;\n                #endif\n\n                vec2 slope = vec2(derivatives.x / (1.0 + derivatives.z), derivatives.y / (1.0 + derivatives.w));\n                normalW = normalize(vec3(-slope.x, 1.0, -slope.y));\n\n                #if defined(CLOSE)\n                    float jacobian = texture2D(_Turbulence_c0, vUVCoords_c0).x + texture2D(_Turbulence_c1, vUVCoords_c1).x + texture2D(_Turbulence_c2, vUVCoords_c2).x;\n                    jacobian = min(1.0, max(0.0, (-jacobian + _FoamBiasLOD2) * _FoamScale));\n                #elif defined(MID)\n                    float jacobian = texture2D(_Turbulence_c0, vUVCoords_c0).x + texture2D(_Turbulence_c1, vUVCoords_c1).x;\n                    jacobian = min(1.0, max(0.0, (-jacobian + _FoamBiasLOD1) * _FoamScale));\n                #else\n                    float jacobian = texture2D(_Turbulence_c0, vUVCoords_c0).x;\n                    jacobian = min(1.0, max(0.0, (-jacobian + _FoamBiasLOD0) * _FoamScale));\n                #endif\n\n                vec2 screenUV = vClipCoords.xy / vClipCoords.w;\n                screenUV = screenUV * 0.5 + 0.5;\n                float backgroundDepth = texture2D(_CameraDepthTexture, screenUV).r * _CameraData.y;\n                float surfaceDepth = vMetric;\n                float depthDifference = max(0.0, (backgroundDepth - surfaceDepth) - 0.1);\n                float foam = texture2D(_FoamTexture, vWorldUV * 0.5 + _Time).r;\n                jacobian += _ContactFoam * saturate(max(0.0, foam - depthDifference) * 5.0) * 0.9;\n    \n                surfaceAlbedo = mix(vec3(0.0), _FoamColor, jacobian);\n\n                vec3 viewDir = normalize(vViewVector);\n                vec3 H = normalize(-normalW + light0.vLightData.xyz);\n                float ViewDotH = pow5(saturate(dot(viewDir, -H))) * 30.0 * _SSSStrength;\n                vec3 color = mix(_Color, saturate(_Color + _SSSColor.rgb * ViewDotH * vLodScales.w), vLodScales.z);\n    \n                float fresnel = dot(normalW, viewDir);\n                fresnel = saturate(1.0 - fresnel);\n                fresnel = pow5(fresnel);\n            "),i.Fragment_Custom_MetallicRoughness("\n                float distanceGloss = mix(1.0 - metallicRoughness.g, _MaxGloss, 1.0 / (1.0 + length(vViewVector) * _RoughnessScale));\n                metallicRoughness.g = 1.0 - mix(distanceGloss, 0.0, jacobian);\n            "),i.Fragment_Before_FinalColorComposition("\n                finalEmissive = mix(color * (1.0 - fresnel), vec3(0.0), jacobian);\n            "),i.Fragment_Before_FragColor("\n                //finalColor = vec4(toGammaSpace((normalW + vec3(1.)) / vec3(2.)), 1.);\n                //finalColor = vec4(vec3(surfaceDepth), 1.);\n            "),i.onBindObservable.add((function(){var e,t,n,a,r,o=((new Date).getTime()/1e3-s._startTime)/10;null===(e=i.getEffect())||void 0===e||e.setVector3("_WorldSpaceCameraPos",s._camera.position),null===(t=i.getEffect())||void 0===t||t.setTexture("_Turbulence_c0",s._wavesGenerator.getCascade(0).turbulence),null===(n=i.getEffect())||void 0===n||n.setTexture("_Turbulence_c1",s._wavesGenerator.getCascade(1).turbulence),null===(a=i.getEffect())||void 0===a||a.setTexture("_Turbulence_c2",s._wavesGenerator.getCascade(2).turbulence),null===(r=i.getEffect())||void 0===r||r.setFloat("_Time",o)})),[2,new Promise((function(e){s._foamTexture.onLoadObservable.addOnce((function(){e(i)}))}))]);case 1:return[4,a.Oie.ParseFromSnippetAsync("R4152I#24",this._scene)];case 2:(i=c.sent()).getInputBlockByPredicate((function(e){return"LOD_scale"===e.name})).value=7.13,i.getInputBlockByPredicate((function(e){return"LengthScale0"===e.name})).value=this._wavesGenerator.lengthScale[0],i.getInputBlockByPredicate((function(e){return"Roughness"===e.name})).value=.311,i.getInputBlockByPredicate((function(e){return"metallic"===e.name})).value=0,i.getBlockByName("Displacement_c0").texture=this._wavesGenerator.getCascade(0).displacement,i.getBlockByName("Derivatives_c0").texture=this._wavesGenerator.getCascade(0).derivatives,i.build(),c.label=3;case 3:return[2,i]}}))},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function a(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof s?r:new s((function(e){e(r)}))).then(n,a)}r((c=c.apply(i,o||[])).next())}));var i,o,s,c},e}()},4059:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SkyBox:()=>o});var a=n(1465),r=n(5454);n(6699);const i=n.p+"0c03bd6e3c9d04da0cf428bbf487bf68.hdr";var o=function(){function e(e,t){var n=this;this._procedural=e,this._scene=t,this._oldSunPosition=new a.Pa4,this._skyMaterial=null,this._probe=null,this._skybox=a.VO7.CreateBox("skyBox",{size:1e3,sideOrientation:a.Kj0.BACKSIDE},this._scene),t.onBeforeRenderObservable.add((function(){var e,a;n._skybox.position=null!==(a=null===(e=t.activeCameras)||void 0===e?void 0:e[0].position)&&void 0!==a?a:t.activeCamera.position})),e?this._initProceduralSkybox():this._initSkybox()}return Object.defineProperty(e.prototype,"probe",{get:function(){return this._probe},enumerable:!1,configurable:!0}),e.prototype.update=function(e){this._procedural&&(this._oldSunPosition.equals(this._skyMaterial.sunPosition)||(this._probe.cubeTexture.refreshRate=0,this._oldSunPosition.copyFrom(this._skyMaterial.sunPosition)),e.position=this._skyMaterial.sunPosition,e.direction=this._skyMaterial.sunPosition.negate().normalize(),e.diffuse=this._skyMaterial.getSunColor())},e.prototype._initProceduralSkybox=function(){var e=this;this._skyMaterial=new r.fE("sky",this._scene),this._skybox.material=this._skyMaterial,this._skybox.material.disableDepthWrite=!0,this._skyMaterial.azimuth=.307,this._skyMaterial.inclination=0,window.ss=this._skyMaterial,this._probe=new a.xNJ("skyProbe",128,this._scene,!0,!0,!0),this._probe.cubeTexture.gammaSpace=!0,this._probe.renderList.push(this._skybox),this._probe.cubeTexture.refreshRate=0,this._probe.cubeTexture.onAfterUnbindObservable.add((function(){var t;(t=e._probe.cubeTexture.getInternalTexture())._sphericalPolynomial=null,t._sphericalPolynomialPromise=null,t._sphericalPolynomialComputed=!1})),this._scene.environmentTexture=this._probe.cubeTexture,this._scene.customRenderTargets.push(this._probe.cubeTexture)},e.prototype._initSkybox=function(){var e=new a.ev7(i,this._scene,512,!1,!0,!1,!0),t=new a.KuD("skyBox",this._scene);t.backFaceCulling=!1,t.reflectionTexture=e,t.reflectionTexture.coordinatesMode=a.xEZ.SKYBOX_MODE,t.diffuseColor=new a.Wot(0,0,0),t.specularColor=new a.Wot(0,0,0),this._skybox.material=t},e}()}}]);
//# sourceMappingURL=41.babylonBundle.js.map
(self.webpackChunkbabylonjs_typescript_webpack_simple_scene=self.webpackChunkbabylonjs_typescript_webpack_simple_scene||[]).push([[811,183],{5811:(t,i,e)=>{"use strict";e.r(i),e.d(i,{RTTDebug:()=>h});var a=e(1465),n=e(6584),r=e(5454),s=e(1183),h=function(){function t(t,i,e){void 0===e&&(e=5),this._engine=i,this._scene=t,this._debugPlaneList=[],this._guiBackgrounds=[],this._guiTexts=[],this._guiButtons=[],this._exrSerializer=new s.EXRSerializer,this._camera=new a.YfP("debug",-Math.PI/2,Math.PI/2,10,new a.Pa4(0,0,0),this._scene),this._camera.mode=a.V1s.ORTHOGRAPHIC_CAMERA,this._camera.layerMask=268435456,this._gui=n.in.CreateFullscreenUI("debugGUI",!0,t),this._gui.layer.layerMask=268435456,this._makePlanes(e)}return Object.defineProperty(t.prototype,"camera",{get:function(){return this._camera},enumerable:!1,configurable:!0}),t.prototype.setTexture=function(t,i,e,a){var n,r=this;void 0===a&&(a=1),this._debugPlaneList[t].material.emissiveTexture=e,1!==a&&(null===(n=this._debugPlaneList[t].material)||void 0===n||n.onBindObservable.add((function(){var i;null===(i=r._debugPlaneList[t].material.getEffect())||void 0===i||i.setFloat("multiplier",a)}))),this._debugPlaneList[t].name=i,this._debugPlaneList[t].material.name=i,this._guiTexts[t].text=i},t.prototype.show=function(t){for(var i=0,e=this._debugPlaneList;i<e.length;i++)e[i].setEnabled(t);for(var a=0,n=this._guiBackgrounds;a<n.length;a++)n[a].isVisible=!1;for(var r=0,s=this._guiTexts;r<s.length;r++)s[r].isVisible=!1;for(var h=0,_=this._guiButtons;h<_.length;h++)_[h].isVisible=!1;this._gui.layer.isEnabled=t},t.prototype._makePlanes=function(t){var i=this,e=new n.rj("grid");e.addRowDefinition(1),this._gui.addControl(e);for(var s=new a.YOI("rttDebug",this._scene),h=function(t){for(var h=a.VO7.CreatePlane("plane"+t,{size:1},_._scene),d=h.getVerticesData("uv"),o=0;o<d.length;o+=2)d[o+1]=1-d[o+1];h.setVerticesData("uv",d),h.layerMask=268435456,h.position.x+=.5,h.position.y-=.5,h.bakeCurrentTransformIntoVertices(),h.parent=s,_._debugPlaneList.push(h);var l=new r.tk("planemat"+t,_._scene);h.material=l,l.AddUniform("multiplier","float","1.0"),l.Fragment_Before_FragColor("\n                color.rgba *= vec4(multiplier);\n            "),l.disableLighting=!0,e.addColumnDefinition(1/32);var g=new n.Ae("text"+t);g.background="green",g.color="white",g.thickness=2,g.width=.95,g.horizontalAlignment=n.oT.HORIZONTAL_ALIGNMENT_CENTER,g.verticalAlignment=n.oT.VERTICAL_ALIGNMENT_TOP,_._guiBackgrounds.push(g);var u=new n.al("title"+t,"");u.color="white",u.horizontalAlignment=n.oT.HORIZONTAL_ALIGNMENT_CENTER,u.verticalAlignment=n.oT.VERTICAL_ALIGNMENT_TOP,u.textHorizontalAlignment=n.oT.HORIZONTAL_ALIGNMENT_CENTER,u.textVerticalAlignment=n.oT.VERTICAL_ALIGNMENT_CENTER,_._guiTexts.push(u);var c=n.zx.CreateSimpleButton("button"+t,"Save");c.width=.7,c.color="white",c.cornerRadius=10,c.background="green",c.horizontalAlignment=n.oT.HORIZONTAL_ALIGNMENT_CENTER,c.verticalAlignment=n.oT.VERTICAL_ALIGNMENT_TOP,c.onPointerUpObservable.add((function(){var e,n,r=i._debugPlaneList[t].material.emissiveTexture;if(r){var s=null!==(n=null===(e=r.getInternalTexture())||void 0===e?void 0:e.format)&&void 0!==n?n:a.gTE.TEXTUREFORMAT_RGBA;r.readPixels().then((function(e){var n=s===a.gTE.TEXTUREFORMAT_R?["R"]:s===a.gTE.TEXTUREFORMAT_RG?["R","G"]:["R","G","B","A"];i._exrSerializer.serialize(r.getSize().width,r.getSize().height,new Float32Array(e.buffer),n),i._exrSerializer.download(i._debugPlaneList[t].name+".exr")}))}})),_._guiButtons.push(c),e.addControl(g,0,t),e.addControl(u,0,t),e.addControl(c,0,t)},_=this,d=0;d<t;++d)h(d);for(d=t;d<32;++d)e.addColumnDefinition(1/32);this._resize(),this._engine.onResizeObservable.add(this._resize.bind(this))},t.prototype._resize=function(){var t=this._engine.getRenderWidth(),i=this._engine.getRenderHeight(),e=t/i;this._camera.orthoLeft=-5*e,this._camera.orthoRight=5*e,this._camera.orthoTop=5,this._camera.orthoBottom=-5,this._camera.getProjectionMatrix(!0);var n=this._camera.getTransformationMatrix().invert(),r=new a.Pa4(-1,1,.001),s=new a.Pa4(-1,1,.001);r.x+=.0015,s.x+=.0015;var h=.0595,_=Math.floor(i*h*e/2+5);this._guiBackgrounds[0].parent.paddingTop=_+"px";for(var d=0;d<this._debugPlaneList.length;++d){var o=this._debugPlaneList[d];s.x+=h;var l=a.Pa4.TransformCoordinates(r,n),g=a.Pa4.TransformCoordinates(s,n).x-l.x;o.scaling.set(g,g,1),o.position.set(l.x,l.y,l.z),s.x+=.003,r.x=s.x,this._guiBackgrounds[d].height=20*t/1920+"px",this._guiTexts[d].height=20*t/1920+"px",this._guiTexts[d].fontSize=8*t/1920+"px",this._guiButtons[d].top=20*t/1920+2+"px",this._guiButtons[d].height=16*t/1920+"px",this._guiButtons[d].fontSize=8*t/1920+"px"}},t}()},1183:(t,i,e)=>{"use strict";e.r(i),e.d(i,{EXRSerializer:()=>h});var a,n,r,s=e(1465);!function(t){t[t.UINT=0]="UINT",t[t.HALF=1]="HALF",t[t.FLOAT=2]="FLOAT"}(a||(a={})),function(t){t[t.NO_COMPRESSION=0]="NO_COMPRESSION",t[t.RLE_COMPRESSION=1]="RLE_COMPRESSION",t[t.ZIPS_COMPRESSION=2]="ZIPS_COMPRESSION",t[t.ZIP_COMPRESSION=3]="ZIP_COMPRESSION",t[t.PIZ_COMPRESSION=4]="PIZ_COMPRESSION",t[t.PXR24_COMPRESSION=5]="PXR24_COMPRESSION",t[t.B44_COMPRESSION=6]="B44_COMPRESSION",t[t.B44A_COMPRESSION=7]="B44A_COMPRESSION"}(n||(n={})),function(t){t[t.INCREASING_Y=0]="INCREASING_Y",t[t.DECREASING_Y=1]="DECREASING_Y",t[t.RANDOM_Y=2]="RANDOM_Y"}(r||(r={}));var h=function(){function t(){this._buffer=new Uint8Array,this._dataLength=0,this._view=new DataView(this._buffer.buffer),this._growSize=2e3}return Object.defineProperty(t.prototype,"buffer",{get:function(){return this._buffer},enumerable:!1,configurable:!0}),t.prototype.serialize=function(t,i,e,s){void 0===s&&(s=["R","G","B","A"]),this._dataLength=0;var h=s.length;this._capacity(t*i*h*4);for(var _=[],d=["A","B","G","R"],o=0,l=0;l<d.length;++l)s.indexOf(d[l])>=0&&(_.push({name:d[l],pixelType:a.FLOAT}),o|=1<<3-l);this._add([118,47,49,1]),this._addInt32(2),this._addHeaderAttribute_chlist("channels",_),this._addHeaderAttribute_compression("compression",n.NO_COMPRESSION),this._addHeaderAttribute_box2i("dataWindow",0,0,t-1,i-1),this._addHeaderAttribute_box2i("displayWindow",0,0,t-1,i-1),this._addHeaderAttribute_lineOrder("lineOrder",r.INCREASING_Y),this._addHeaderAttribute_float("pixelAspectRatio",1),this._addHeaderAttribute_v2f("screenWindowCenter",0,0),this._addHeaderAttribute_float("screenWindowWidth",t),this._addNull();for(var g=[],u=8*i,c=t*h*4,f=this._dataLength+u,p=0;p<i;++p)g.push(BigInt(f)),f+=c+8;for(this._addUint64(g),p=0;p<i;++p){this._addUint32(p),this._addUint32(c);for(var b=3;b>=0;--b)if(o&1<<b)for(var y=0;y<t;++y){var v=e[p*t*h+y*h+b];this._addFloat(v)}}this._buffer=this._buffer.slice(0,this._dataLength),this._view=new DataView(this._buffer.buffer)},t.prototype.download=function(t){s.w1W.Download(new Blob([this._buffer.buffer],{type:"application/octet-stream"}),t)},t.prototype._addHeaderAttribute_chlist=function(t,i){this._addString(t),this._addNull(),this._addString("chlist"),this._addNull();for(var e=1,a=0;a<i.length;++a)e+=i[a].name.length+1,e+=16;for(this._addUint32(e),a=0;a<i.length;++a){var n=i[a];this._addString(n.name),this._addNull(),this._addInt32(n.pixelType),this._addUint8(0),this._addNull(3),this._addInt32([1,1])}this._addNull()},t.prototype._addHeaderAttribute_compression=function(t,i){this._addString(t),this._addNull(),this._addString("compression"),this._addNull(),this._addUint32(1),this._addUint8(i)},t.prototype._addHeaderAttribute_box2i=function(t,i,e,a,n){this._addString(t),this._addNull(),this._addString("box2i"),this._addNull(),this._addUint32(16),this._addInt32([i,e,a,n])},t.prototype._addHeaderAttribute_lineOrder=function(t,i){this._addString(t),this._addNull(),this._addString("lineOrder"),this._addNull(),this._addUint32(1),this._addUint8(i)},t.prototype._addHeaderAttribute_float=function(t,i){this._addString(t),this._addNull(),this._addString("float"),this._addNull(),this._addUint32(4),this._addFloat(i)},t.prototype._addHeaderAttribute_v2f=function(t,i,e){this._addString(t),this._addNull(),this._addString("v2f"),this._addNull(),this._addUint32(8),this._addFloat([i,e])},t.prototype._addString=function(t){this._capacity(t.length);for(var i=0;i<t.length;++i)this._view.setUint8(this._dataLength++,t.charCodeAt(i))},t.prototype._addInt8=function(t){if(Array.isArray(t)){this._capacity(t.length);for(var i=0;i<t.length;++i)this._view.setInt8(this._dataLength++,t[i])}else this._capacity(1),this._view.setInt8(this._dataLength,t),this._dataLength+=1},t.prototype._addUint8=function(t){this._capacity(1),this._view.setUint8(this._dataLength,t),this._dataLength+=1},t.prototype._addInt16=function(t){if(Array.isArray(t)){this._capacity(2*t.length);for(var i=0;i<t.length;++i)this._view.setInt16(this._dataLength,t[i],!0),this._dataLength+=2}else this._capacity(2),this._view.setInt16(this._dataLength,t,!0),this._dataLength+=2},t.prototype._addUint16=function(t){if(Array.isArray(t)){this._capacity(2*t.length);for(var i=0;i<t.length;++i)this._view.setUint16(this._dataLength,t[i],!0),this._dataLength+=2}else this._view.setUint16(this._dataLength,t,!0),this._dataLength+=2},t.prototype._addInt32=function(t){if(Array.isArray(t)){this._capacity(4*t.length);for(var i=0;i<t.length;++i)this._view.setInt32(this._dataLength,t[i],!0),this._dataLength+=4}else this._capacity(4),this._view.setInt32(this._dataLength,t,!0),this._dataLength+=4},t.prototype._addUint32=function(t){if(Array.isArray(t)){this._capacity(4*t.length);for(var i=0;i<t.length;++i)this._view.setUint32(this._dataLength,t[i],!0),this._dataLength+=4}else this._capacity(4),this._view.setUint32(this._dataLength,t,!0),this._dataLength+=4},t.prototype._addUint64=function(t){if(Array.isArray(t)){this._capacity(8*t.length);for(var i=0;i<t.length;++i)this._view.setBigUint64(this._dataLength,t[i],!0),this._dataLength+=8}else for(this._capacity(t.byteLength),i=0;i<t.length;++i)this._view.setBigUint64(this._dataLength,t[i],!0),this._dataLength+=8},t.prototype._addFloat=function(t){if(Array.isArray(t)){this._capacity(4*t.length);for(var i=0;i<t.length;++i)this._view.setFloat32(this._dataLength,t[i],!0),this._dataLength+=4}else t instanceof Float32Array?(this._capacity(t.byteLength),this._buffer.set(t,this._dataLength),this._dataLength+=t.byteLength):(this._capacity(4),this._view.setFloat32(this._dataLength,t,!0),this._dataLength+=4)},t.prototype._addNull=function(t){for(void 0===t&&(t=1),this._capacity(t);t-- >0;)this._view.setUint8(this._dataLength++,0)},t.prototype._add=function(t){Array.isArray(t)&&(t=new Uint8Array(t));var i=t.byteLength;this._capacity(i),this._buffer.set(t,this._dataLength),this._dataLength+=i},t.prototype._capacity=function(t){this._dataLength+t<=this._buffer.byteLength||this._growBuffer(Math.max(this._growSize,t))},t.prototype._growBuffer=function(t){var i=new Uint8Array(this._buffer.byteLength+t);i.set(this._buffer,0),this._buffer=i,this._view=new DataView(this._buffer.buffer)},t}()}}]);
//# sourceMappingURL=811.babylonBundle.js.map
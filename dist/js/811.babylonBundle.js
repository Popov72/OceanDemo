(self.webpackChunkbabylonjs_ocean_demo=self.webpackChunkbabylonjs_ocean_demo||[]).push([[811,183],{5811:(t,e,i)=>{"use strict";i.r(e),i.d(e,{RTTDebug:()=>h});var a=i(2264),n=i(1975),r=i(9781),s=i(1183),h=function(){function t(t,e,i){void 0===i&&(i=5),this._engine=e,this._scene=t,this._debugPlaneList=[],this._guiBackgrounds=[],this._guiTexts=[],this._guiButtons=[],this._exrSerializer=new s.EXRSerializer,this._camera=new a.ArcRotateCamera("debug",-Math.PI/2,Math.PI/2,10,new a.Vector3(0,0,0),this._scene),this._camera.mode=a.Camera.ORTHOGRAPHIC_CAMERA,this._camera.layerMask=268435456,this._gui=n.in.CreateFullscreenUI("debugGUI",!0,t),this._gui.layer.layerMask=268435456,this._makePlanes(i)}return Object.defineProperty(t.prototype,"camera",{get:function(){return this._camera},enumerable:!1,configurable:!0}),t.prototype.setTexture=function(t,e,i,a){var n,r=this;void 0===a&&(a=1),this._debugPlaneList[t].material.emissiveTexture=i,1!==a&&(null===(n=this._debugPlaneList[t].material)||void 0===n||n.onBindObservable.add((function(){var e;null===(e=r._debugPlaneList[t].material.getEffect())||void 0===e||e.setFloat("multiplier",a)}))),this._debugPlaneList[t].name=e,this._debugPlaneList[t].material.name="rttDebug_"+e,this._guiTexts[t].text=e},Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._gui.layer.isEnabled},enumerable:!1,configurable:!0}),t.prototype.show=function(t){for(var e=0,i=this._debugPlaneList;e<i.length;e++)i[e].setEnabled(t);for(var a=0,n=this._guiBackgrounds;a<n.length;a++)n[a].isVisible=t;for(var r=0,s=this._guiTexts;r<s.length;r++)s[r].isVisible=t;for(var h=0,d=this._guiButtons;h<d.length;h++)d[h].isVisible=t;this._gui.layer.isEnabled=t},t.prototype._makePlanes=function(t){var e=this,i=new n.rj("grid");i.addRowDefinition(1),this._gui.addControl(i);for(var s=new a.TransformNode("rttDebug",this._scene),h=function(t){for(var h=a.MeshBuilder.CreatePlane("plane"+t,{size:1},d._scene),o=h.getVerticesData("uv"),_=0;_<o.length;_+=2)o[_+1]=1-o[_+1];h.setVerticesData("uv",o),h.layerMask=268435456,h.position.x+=.5,h.position.y-=.5,h.bakeCurrentTransformIntoVertices(),h.parent=s,d._debugPlaneList.push(h);var l=new r.tk("planemat"+t,d._scene);h.material=l,l.AddUniform("multiplier","float","1.0"),l.Fragment_Before_FragColor("\n                color.rgba *= vec4(multiplier);\n            "),l.disableLighting=!0,i.addColumnDefinition(1/32);var u=new n.Ae("text"+t);u.background="green",u.color="white",u.thickness=2,u.width=.95,u.horizontalAlignment=n.oT.HORIZONTAL_ALIGNMENT_CENTER,u.verticalAlignment=n.oT.VERTICAL_ALIGNMENT_TOP,d._guiBackgrounds.push(u);var g=new n.al("title"+t,"");g.color="white",g.horizontalAlignment=n.oT.HORIZONTAL_ALIGNMENT_CENTER,g.verticalAlignment=n.oT.VERTICAL_ALIGNMENT_TOP,g.textHorizontalAlignment=n.oT.HORIZONTAL_ALIGNMENT_CENTER,g.textVerticalAlignment=n.oT.VERTICAL_ALIGNMENT_CENTER,d._guiTexts.push(g);var c=n.zx.CreateSimpleButton("button"+t,"Save");c.width=.7,c.color="white",c.cornerRadius=10,c.background="green",c.horizontalAlignment=n.oT.HORIZONTAL_ALIGNMENT_CENTER,c.verticalAlignment=n.oT.VERTICAL_ALIGNMENT_TOP,c.onPointerUpObservable.add((function(){var i,n,r=e._debugPlaneList[t].material.emissiveTexture;if(r){var s=null!==(n=null===(i=r.getInternalTexture())||void 0===i?void 0:i.format)&&void 0!==n?n:a.Constants.TEXTUREFORMAT_RGBA;r.readPixels().then((function(i){var n=s===a.Constants.TEXTUREFORMAT_R?["R"]:s===a.Constants.TEXTUREFORMAT_RG?["R","G"]:["R","G","B","A"];e._exrSerializer.serialize(r.getSize().width,r.getSize().height,new Float32Array(i.buffer),n),e._exrSerializer.download(e._debugPlaneList[t].name+".exr")}))}})),d._guiButtons.push(c),i.addControl(u,0,t),i.addControl(g,0,t),i.addControl(c,0,t)},d=this,o=0;o<t;++o)h(o);for(o=t;o<32;++o)i.addColumnDefinition(1/32);this._resize(),this._engine.onResizeObservable.add(this._resize.bind(this))},t.prototype._resize=function(){var t=this._engine.getRenderWidth(),e=this._engine.getRenderHeight(),i=t/e;this._camera.orthoLeft=-5*i,this._camera.orthoRight=5*i,this._camera.orthoTop=5,this._camera.orthoBottom=-5,this._camera.getProjectionMatrix(!0);var n=this._camera.getTransformationMatrix().invert(),r=.0595,s=Math.floor(e*r*i/2+5),h=new a.Vector3(-1,1-r*i,.001),d=new a.Vector3(-1,1-r*i,.001);h.x+=.0015,d.x+=.0015,this._guiBackgrounds[0].parent.paddingTop=s+"px";for(var o=0;o<this._debugPlaneList.length;++o){var _=this._debugPlaneList[o];d.x+=r;var l=a.Vector3.TransformCoordinates(h,n),u=a.Vector3.TransformCoordinates(d,n).x-l.x;_.scaling.set(u,u,1),_.position.set(l.x,l.y,l.z),d.x+=.003,h.x=d.x,this._guiBackgrounds[o].height=20*t/1920+"px",this._guiTexts[o].height=20*t/1920+"px",this._guiTexts[o].fontSize=8*t/1920+"px",this._guiButtons[o].top=20*t/1920+2+"px",this._guiButtons[o].height=16*t/1920+"px",this._guiButtons[o].fontSize=8*t/1920+"px"}},t}()},1183:(t,e,i)=>{"use strict";i.r(e),i.d(e,{EXRSerializer:()=>h});var a,n,r,s=i(2281);!function(t){t[t.UINT=0]="UINT",t[t.HALF=1]="HALF",t[t.FLOAT=2]="FLOAT"}(a||(a={})),function(t){t[t.NO_COMPRESSION=0]="NO_COMPRESSION",t[t.RLE_COMPRESSION=1]="RLE_COMPRESSION",t[t.ZIPS_COMPRESSION=2]="ZIPS_COMPRESSION",t[t.ZIP_COMPRESSION=3]="ZIP_COMPRESSION",t[t.PIZ_COMPRESSION=4]="PIZ_COMPRESSION",t[t.PXR24_COMPRESSION=5]="PXR24_COMPRESSION",t[t.B44_COMPRESSION=6]="B44_COMPRESSION",t[t.B44A_COMPRESSION=7]="B44A_COMPRESSION"}(n||(n={})),function(t){t[t.INCREASING_Y=0]="INCREASING_Y",t[t.DECREASING_Y=1]="DECREASING_Y",t[t.RANDOM_Y=2]="RANDOM_Y"}(r||(r={}));var h=function(){function t(){this._buffer=new Uint8Array(0),this._dataLength=0,this._view=new DataView(this._buffer.buffer),this._growSize=2e3}return Object.defineProperty(t.prototype,"buffer",{get:function(){return this._buffer},enumerable:!1,configurable:!0}),t.prototype.serialize=function(t,e,i,s){void 0===s&&(s=["R","G","B","A"]),this._dataLength=0;var h=s.length;this._capacity(t*e*h*4);for(var d=[],o=["A","B","G","R"],_=0,l=0;l<o.length;++l)s.indexOf(o[l])>=0&&(d.push({name:o[l],pixelType:a.FLOAT}),_|=1<<3-l);this._add([118,47,49,1]),this._addInt32(2),this._addHeaderAttribute_chlist("channels",d),this._addHeaderAttribute_compression("compression",n.NO_COMPRESSION),this._addHeaderAttribute_box2i("dataWindow",0,0,t-1,e-1),this._addHeaderAttribute_box2i("displayWindow",0,0,t-1,e-1),this._addHeaderAttribute_lineOrder("lineOrder",r.INCREASING_Y),this._addHeaderAttribute_float("pixelAspectRatio",1),this._addHeaderAttribute_v2f("screenWindowCenter",0,0),this._addHeaderAttribute_float("screenWindowWidth",t),this._addNull();for(var u=[],g=8*e,c=t*h*4,f=this._dataLength+g,p=0;p<e;++p)u.push(BigInt(f)),f+=c+8;for(this._addUint64(u),p=0;p<e;++p){this._addUint32(p),this._addUint32(c);for(var b=3;b>=0;--b)if(_&1<<b)for(var y=0;y<t;++y){var A=i[p*t*h+y*h+b];this._addFloat(A)}}this._buffer=this._buffer.slice(0,this._dataLength),this._view=new DataView(this._buffer.buffer)},t.prototype.download=function(t){s.w1.Download(new Blob([this._buffer.buffer],{type:"application/octet-stream"}),t)},t.prototype._addHeaderAttribute_chlist=function(t,e){this._addString(t),this._addNull(),this._addString("chlist"),this._addNull();for(var i=1,a=0;a<e.length;++a)i+=e[a].name.length+1,i+=16;for(this._addUint32(i),a=0;a<e.length;++a){var n=e[a];this._addString(n.name),this._addNull(),this._addInt32(n.pixelType),this._addUint8(0),this._addNull(3),this._addInt32([1,1])}this._addNull()},t.prototype._addHeaderAttribute_compression=function(t,e){this._addString(t),this._addNull(),this._addString("compression"),this._addNull(),this._addUint32(1),this._addUint8(e)},t.prototype._addHeaderAttribute_box2i=function(t,e,i,a,n){this._addString(t),this._addNull(),this._addString("box2i"),this._addNull(),this._addUint32(16),this._addInt32([e,i,a,n])},t.prototype._addHeaderAttribute_lineOrder=function(t,e){this._addString(t),this._addNull(),this._addString("lineOrder"),this._addNull(),this._addUint32(1),this._addUint8(e)},t.prototype._addHeaderAttribute_float=function(t,e){this._addString(t),this._addNull(),this._addString("float"),this._addNull(),this._addUint32(4),this._addFloat(e)},t.prototype._addHeaderAttribute_v2f=function(t,e,i){this._addString(t),this._addNull(),this._addString("v2f"),this._addNull(),this._addUint32(8),this._addFloat([e,i])},t.prototype._addString=function(t){this._capacity(t.length);for(var e=0;e<t.length;++e)this._view.setUint8(this._dataLength++,t.charCodeAt(e))},t.prototype._addInt8=function(t){if(Array.isArray(t)){this._capacity(t.length);for(var e=0;e<t.length;++e)this._view.setInt8(this._dataLength++,t[e])}else this._capacity(1),this._view.setInt8(this._dataLength,t),this._dataLength+=1},t.prototype._addUint8=function(t){this._capacity(1),this._view.setUint8(this._dataLength,t),this._dataLength+=1},t.prototype._addInt16=function(t){if(Array.isArray(t)){this._capacity(2*t.length);for(var e=0;e<t.length;++e)this._view.setInt16(this._dataLength,t[e],!0),this._dataLength+=2}else this._capacity(2),this._view.setInt16(this._dataLength,t,!0),this._dataLength+=2},t.prototype._addUint16=function(t){if(Array.isArray(t)){this._capacity(2*t.length);for(var e=0;e<t.length;++e)this._view.setUint16(this._dataLength,t[e],!0),this._dataLength+=2}else this._view.setUint16(this._dataLength,t,!0),this._dataLength+=2},t.prototype._addInt32=function(t){if(Array.isArray(t)){this._capacity(4*t.length);for(var e=0;e<t.length;++e)this._view.setInt32(this._dataLength,t[e],!0),this._dataLength+=4}else this._capacity(4),this._view.setInt32(this._dataLength,t,!0),this._dataLength+=4},t.prototype._addUint32=function(t){if(Array.isArray(t)){this._capacity(4*t.length);for(var e=0;e<t.length;++e)this._view.setUint32(this._dataLength,t[e],!0),this._dataLength+=4}else this._capacity(4),this._view.setUint32(this._dataLength,t,!0),this._dataLength+=4},t.prototype._addUint64=function(t){if(Array.isArray(t)){this._capacity(8*t.length);for(var e=0;e<t.length;++e)this._view.setBigUint64(this._dataLength,t[e],!0),this._dataLength+=8}else for(this._capacity(t.byteLength),e=0;e<t.length;++e)this._view.setBigUint64(this._dataLength,t[e],!0),this._dataLength+=8},t.prototype._addFloat=function(t){if(Array.isArray(t)){this._capacity(4*t.length);for(var e=0;e<t.length;++e)this._view.setFloat32(this._dataLength,t[e],!0),this._dataLength+=4}else t instanceof Float32Array?(this._capacity(t.byteLength),this._buffer.set(t,this._dataLength),this._dataLength+=t.byteLength):(this._capacity(4),this._view.setFloat32(this._dataLength,t,!0),this._dataLength+=4)},t.prototype._addNull=function(t){for(void 0===t&&(t=1),this._capacity(t);t-- >0;)this._view.setUint8(this._dataLength++,0)},t.prototype._add=function(t){Array.isArray(t)&&(t=new Uint8Array(t));var e=t.byteLength;this._capacity(e),this._buffer.set(t,this._dataLength),this._dataLength+=e},t.prototype._capacity=function(t){this._dataLength+t<=this._buffer.byteLength||this._growBuffer(Math.max(this._growSize,t))},t.prototype._growBuffer=function(t){var e=new Uint8Array(this._buffer.byteLength+t);e.set(this._buffer,0),this._buffer=e,this._view=new DataView(this._buffer.buffer)},t}()}}]);
//# sourceMappingURL=811.babylonBundle.js.map